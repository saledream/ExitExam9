{% extends "admin/base_site.html" %}
{% load i18n static jazzmin %}
{% get_jazzmin_ui_tweaks as jazzmin_ui %}

{% block bodyclass %}{{ block.super }} dashboard{% endblock %}

{% block content_title %}
    {% if request.user.is_superuser or request.user.user_type == 'admin' %} 
        {% trans 'Admin Dashboard' %}
    {% else %}
        {% trans 'Instructor Dashboard' %}
    {% endif %}
 {% endblock %}

{% block breadcrumbs %}
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'admin:index' %}">{% trans 'Home' %}</a></li>
        <li class="breadcrumb-item">{% trans 'Dashboard' %}</li>
    </ol>
{% endblock %}


{% block content %}
{% get_side_menu using="app_list" as dashboard_list %}
    {% if dashboard_list %}
        {% widthratio dashboard_list|length 2 1 as middle %}
    {% endif %}

   {% with user_type=request.user.user_type %}
        
            <div class="col-lg-9 col-12">

                <div class="row">
                    {% if request.user.is_superuser %}
                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                            <div>
                                <h1> {{jazzmin_settings.models.users}} </h1>
                            </div>
                            <div class="card-body">
                                
                                {% for app in dashboard_list %} 
                                        
                                        {% for model in app.models %}
                                        <!-- {{model}} -->
                                        {% if app.name == 'Accounts' and model.name == 'Users' %}
                                            <a href="{{model.url}}">{{model.name}}</a> 
                        
                                            {% endif %}
                                        {% endfor %}
                        
                                {% endfor %}
                                        
                                </div>
                        </div>
                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                            <div>
                              
                            <h1> {{jazzmin_settings.models.departments}}</h1>
                            
                            </div>
                            <div class="card-body">
                            {% for app in dashboard_list %} 
                                    
                                {% for model in app.models %}
                                    {% if app.name == 'Eecommittee' and model.name == 'Departments' %}
                                    <a href="{{model.url}}">{{model.name}}</a> 
                    
                                    {% endif %}
                                {% endfor %}
                                {% endfor %}
                            </div>
                        </div>

                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                            <div>
                            <h1> {{jazzmin_settings.models.courses}}</h1>
                            </div>
                            <div class="card-body">
                            {% for app in dashboard_list %} 
                                        
                                {% for model in app.models %}
                                    {% if app.name == 'Eecommittee' and model.name == 'Courses' %}
                                    <a href="{{model.url}}">{{model.name}}</a> 
                    
                                    {% endif %}
                                {% endfor %}
                    
                                {% endfor %}
                            </div>
                        </div>

                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                                <div>
                                    <h1> {{jazzmin_settings.models.modules}}</h1>
                                </div>
                                <div class="card-body">
                                    {% for app in dashboard_list %} 
                                            
                                        {% for model in app.models %}
                                            {% if app.name == 'Instructor' and model.name == 'Modules' %}
                                            
                                            <a href="{{model.url}}">{{model.name}}</a> 

                                            {% endif %}
                                        {% endfor %}
                            
                                    {% endfor %}
                            
                                </div>
                        </div>  
                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">

                                <div>
                                    <h1> {{jazzmin_settings.models.tests}}</h1>
                                </div>
                                <div class="card-body">
                                
                                {% for app in dashboard_list %} 
                                        
                                    {% for model in app.models %}
                              
                                        {% if app.name == 'Instructor' and model.name == 'Tests' %}
                                        <a href="{{model.url}}">{{model.name}}</a> 
                        
                                        {% endif %}
                                    {% endfor %}
                        
                                {% endfor %}
                            
                                </div>
                        </div>

                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                            <div>
                                <h1> {{jazzmin_settings.models.models}} </h1>
                            </div>
                            <div class="card-body">
                            {% for app in dashboard_list %} 
                                        
                                {% for model in app.models %}
                                    {% if app.name == 'Instructor' and model.name == 'Exam_ models' %}
                                    <a href="{{model.url}}">{{model.name}}</a> 
                    
                                    {% endif %}
                                {% endfor %}
                    
                            {% endfor %}
                    
                            </div>
                        </div>

                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                                <div>
                                    <h1> {{jazzmin_settings.models.totalTestQ}} </h1>
                                </div>
                                <div class="card-body">
                                {% for app in dashboard_list %} 
                                            
                                    {% for model in app.models %}
                                        
                                        {% if app.name == 'Instructor' and model.name == 'Test questions' %}
                                        <a href="{{model.url}}">{{model.name}}</a>  
                        
                                        {% endif %}
                                    {% endfor %}
                        
                                {% endfor %}
                                </div>
                        </div>
                        <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                            <div>
                                <h1> {{jazzmin_settings.models.totalModelQ}} </h1>
                            </div>
                            <div class="card-body">
                            {% for app in dashboard_list %} 
                                        
                                {% for model in app.models %}
                                   
                                    {% if app.name == 'Instructor' and model.name == 'Model questions' %}
                                    <a href="{{model.url}}">{{model.name}}</a>  
                    
                                    {% endif %}
                                {% endfor %}
                    
                            {% endfor %}
                            </div>
                        </div>
                
                    {% elif user_type == 'instructor' %} 
                    <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                        <div hx-get="/students/questions/" hx-trigger="load">
                            <h1></h1>
                        </div>
                        <div class="card-body">
                    
                            {% for app in dashboard_list %} 
                                    
                                    {% for model in app.models %}
                                    
                                       <div>
                                        {% if app.name == 'Instructor' and model.name == 'Model questions' %}
                                            <a href="{{model.url}}">{{model.name}} </a> 
                                        {% endif %}
                                       </div>
                                       <div>
                                        {% if app.name == 'Instructor' and model.name == 'Test questions' %}
                                            <a href="{{model.url}}">{{model.name}} </a> 

                                        {% endif %} 
                                       </div>

                                    {% endfor %}
                    
                            {% endfor %}
                            
                         </div>
                    </div>
                <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                    <div hx-get="/students/cppages/" hx-trigger="load">
                        <h1> 20 </h1>
                    </div>
                        <div class="card-body">
                            {% for app in dashboard_list %} 
                                
                                {% for model in app.models %}
                                 
                                    {% if app.name == 'Instructor' and model.name == 'Page completions' %}
                                    <a href="{{model.url}}">{{model.name}} </a> 
                    
                                    {% endif %}
                                {% endfor %}
                            {% endfor %}
                        </div>
               </div>
                <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                    <div hx-get="/students/pages/" hx-trigger="load">
                        <h1> 20 </h1>
                    </div>
                    <div class="card-body">
                        {% for app in dashboard_list %} 
                                
                            {% for model in app.models %}
                                {% if app.name == 'Instructor' and model.name == 'Pages' %}
                                <a href="{{model.url}}">{{model.name}}</a> 
                
                                {% endif %}
                            {% endfor %}
            
                        {% endfor %}
                    </div>
                </div>

                <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                    <div hx-get="/students/modules/" hx-trigger="load">
                        <h1> 20 </h1>
                    </div>
                    <div class="card-body">
                    
                        {% for app in dashboard_list %} 
                            
                            {% for model in app.models %}
                                {% if app.name == 'Instructor' and model.name == 'Modules' %}
                                <a href="{{model.url}}">{{model.name}}</a> 
                
                                {% endif %}
                            {% endfor %}
            
                        {% endfor %}
                
                    </div>
                </div>
                <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                    <div hx-get="/students/models/" hx-trigger="load">
                        <h1> 20 </h1>
                    </div>
                    <div class="card-body">
                        {% for app in dashboard_list %} 
                                
                            {% for model in app.models %}
                                {% if app.name == 'Instructor' and model.name == 'Exam_ models' %}
                                <a href="{{model.url}}">{{model.name}}</a> 
                
                                {% endif %}
                            {% endfor %}
            
                        {% endfor %}
            
                    </div>
                </div>
                <div class="card col-lg-3 col-10 col-md-5 mx-3" style="width: 18rem;">
                    <div  hx-get="/students/tests/" hx-trigger="load">
                        <h1> 20 </h1>
                    </div>
                    <div class="card-body">
                        {% for app in dashboard_list %} 
                                
                            {% for model in app.models %}
                                {% if app.name == 'Instructor' and model.name == 'Tests' %}
                                <a href="{{model.url}}">{{model.name}} </a> 
                
                                {% endif %}
                            {% endfor %}
                
                        {% endfor %}
                    </div>
                </div>

                </div>
            </div>
        {% endif %}
    {% endwith %} 
    <div class="col-lg-9 col-12">
        <div id="content-related">
            <div class="module" id="recent-actions-module">
                <h4 class="mb-3">{% trans 'Recent actions' %}</h4>
                {% load log %}
                {% get_admin_log 6 as admin_log for_user user %}
                {% if not admin_log %}
                    <p>{% trans 'None available' %}</p>
                {% else %}
                    <div class="timeline">
                        {% for entry in admin_log %}
                            <div>
                                {% if entry.is_change %}
                                    <i class="fas fa-edit bg-gray text-xs"></i>
                                {% elif entry.is_deletion %}
                                    <i class="fas fa-trash bg-danger text-xs"></i>
                                {% elif entry.is_addition %}
                                    <i class="fas fa-plus-circle bg-success text-xs"></i>
                                {% endif %}

                                <div class="timeline-item">
                                    <span class="time"><i class="fas fa-clock"></i> {% blocktrans with timesince=entry.action_time|timesince %}{{ timesince }} ago{% endblocktrans %}</span>
                                    <h3 class="timeline-header no-border">
                                        {% if entry.is_deletion or not entry.get_admin_url %}
                                            {{ entry.object_repr }}
                                        {% else %}
                                            <a href="{{ entry.get_admin_url }}">{{ entry.object_repr|safe|truncatewords:'15' }}</a>
                                        {% endif %}

                                        {% if entry.model %}
                                            <span class="mini quiet">
                                                {% filter capfirst %}
                                                    {{ entry.model }}
                                                {% endfilter %}
                                            </span>
                                        {% endif %}
                                    </h3>
                                    {% if not entry.is_deletion %}
                                        <div class="timeline-body">
                                            {% if entry.is_addition %}
                                                {{ entry }}
                                            {% else %}
                                                <ul style="list-style: none; padding: 0;">
                                                    {% action_message_to_list entry as action_message_list %}
                                                    {% for action_message in action_message_list %}
                                                        <li>{{ action_message.msg|style_bold_first_word }}</li>
                                                    {% endfor %}
                                                </ul>
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                        <div>
                            <i class="fa fa-clock bg-gray"></i>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
 
{% endblock %}
